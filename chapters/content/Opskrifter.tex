\section{Opskrifter}
I dette afsnit beskrives hvordan implementeringen af opskrifter er designet udført, og hvordan implementeringen har opfyldt user story 13, 15, 16, 17, og 18. 
User story 14, at finde anbefalinger på opskrifter, hører også til opskriftskomponenten, men vil blive uddybet i \myref{anbefaling}. Til sidst samles alt dette op i en konklusion. 
Opskrifter i dette projekt har som udgangspunkt rødder i user story 13, som beskriver at brugeren ville have mulighed for at kunne finde opskrifter.
\subsection{Design}
Idéen er at give brugeren mulighed for nemt at finde opskrifter, hvorefter ingredienserne fra disse, nemt kan tilføjes til deres indkøbsliste(r).
Når man først går ind på opskrifterne, bliver man mødt af alle offentliggjorte opskrifter, som er blevet tilføjet af brugerne af systemet.
Opskrifterne er opstillet således der på forsiden for opskrifter kan ses den mest nødvendige information om hver enkelt opskrift.
Opskrifterne er opstillet vha. Bootstraps CSS klasse \class{panels} for at give en klar opdeling og en gøre det overskueligt.
Opskrifterne indeholder alle sammen en titel, tid, antal personer, bedømmelse, ingredienser og en fremgangsmåde.

Hver opskrift er relateret til brugeren som har oprettet den, denne bruger har senere mulighed for at redigere eller slette opskriften.
Er man ikke den bruger der har oprettet opskriften, har man mulighed for at kunne klone opskriften, dette er fra user story 18.
Når en opskrift bliver klonet, bliver alt data fra den tidligere opskrift kopieret og derefter kan man foretage ændringer til opskriften, gemme den under et nyt navn, således opskriften kan personliggøres.

Brugerne har efterspurgt mulighed for at kunne tilføje ingredienser fra opskriften til deres indkøbs liste, i følge user story 16.
Ingredienser på opskriften er opstillet således de nemt kan tilføjes til brugerens indkøbslister.
Det er muligt kun at vælge de ting man mangler, således man ikke er tvunget til at tilføje alle ingredienser fra hele opskriften.
Der kan vælges hvilken indkøbsliste varerne skal tilføjes til, og det kan ses hvilke ting der allerrede er blevet tilføjet fra opskriften, i form af små grønne flueben.


Der er på baggrund af user story 17 gjort det muligt at der inde på den enkelte opskrift kan vælges hvor mange personer man ønsker at opskriften skal skaleres til.
Der er taget udgangspunkt i fire personer, men der er mulighed for at både sænke og hæve denne værdi for at tilpasse mængden på ingredienserne, således den passer til det valgte antal mennesker.


Hver opskrift har mulighed for, at en bruger kan vurdere dem på en skala fra 1 til 5.
Dette angives i form af stjerner.
Dette er gjort da der i følge user story 15 er en efterspørgsel på at kunne vurdere opskrifter.
Brugerne kan se den gennemsnitlige vurdering på den enkelte opskrift, og ud fra dette tage en beslutning om hvorvidt man skal prøve den ene eller den anden opskrift.
Brugen af disse vurderinger, bliver beskrevet i \myref{anbefaling}.


\subsection{Implementering}
\textbf{Opskrift}
Selve opskriften er en klasse set på \myref{diagram:klassediagram}.
Objektet bliver instantieret når en bruger prøver at oprette en ny opskrift eller prøver at oprette en kopi af en allerrede eksisterende opskrift.


\begin{lstlisting}[caption=Klassen \class{Recipe}]
public class Recipe
{
    public int ID { get; set; }
    public string OriginalAuthorName { get; set; }
    public string AuthorName { get; set; }
    public string Title { get; set; }
    public ICollection<Item> Ingredients { get; set; }
    public int Minutes { get; set; }
    public string Instructions { get; set; }
    public ICollection<Rating> Ratings { get; set; }

    public Recipe()
    {
        Ingredients = new List<Item>();
        Ratings = new List<Rating>();
    }
}
\end{lstlisting}

\class{AddIngredient}
\class{AddIngredient} er en metode til at tilføje generiske varer til opskrifterne, således de kan skaleres med antallet af personer valgt. 
\class{AddIngredient} er en metode der ligner \class{AddItem} fra \class{ShoppingListsController}. 
\class{AddIngredient} udskiller sig på at der ikke bliver fundet tilbud på varen, og varen bliver lagt til en opskrift i stedet for en indkøbsliste.


\begin{lstlisting}[caption="Udklip fra \class{AddIngredient} som opretter og tilføjer ingredienser til en specifik opskrift - Her er vist hvad der er forskel fra \class{AddItem} i \class{ShoppingListsController}"]
/* [...] */      
// If recipe contains tempIngredient add ingredient, else initiate ingredient and then add it.
if (recipe.Ingredients.Contains(tmpIngredient))
{
    _db.Recipe_Ingredient
       .First(i => i.Recipe == recipe 
       	   && i.Ingredient == tmpIngredient).AmountPerPerson = (double)amountPerPerson;
}
else
{
    var recipeIngredient = new Recipe_Ingredient { 
    	RecipeID = id, 
    	Ingredient = tmpIngredient, 
    	AmountPerPerson = (double)amountPerPerson, 
    	Unit = unit };
    recipe.Ingredients.Add(tmpIngredient);
    _db.Recipe_Ingredient.Add(recipeIngredient);
}
/* [...] */          
\end{lstlisting}


\subsection{Konklusion}
Implementeringen af opskrifter virker efter hensigten. 
Alle user stories vedrørende opskrifter bliver opfyldt. 
Opskrifter er skrevet sammen med indkøbslisten og der er funktionalitet til at tilføje varer dertil. 
Brugeren kan ændre på enkelte opskrifter eller oprette sin egen version af andres opskrifter. 
Opskrifterne kan skaleres efter antal personer og har et etableret vurderingssystem. 
Alle opskrifter og dets information bliver gemt i databasen på en hensigtsmæssig måde.
